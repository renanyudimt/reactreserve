{"ast":null,"code":"import Order from \"../../models/Order\";\nimport jwt from \"jsonwebtoken\";\nimport connectDb from \"../../utils/connectDb\";\nconnectDb();\nexport default (async (req, res) => {\n  try {\n    const {\n      userId\n    } = jwt.verify(req.headers.authorization, process.env.JWT_SECRET);\n    const orders = await Order.find({\n      userId: userId\n    }).populate({\n      path: \"products.product\",\n      model: \"Product\"\n    }); //populate serve pra buscar as informaçoes do produto baseado no model Product, se nao tiver isso nao busca todas as infos dos produtos\n    //o que nao é interessante, uma vez que se com populate eu posso popular os dados de acordo com o id e o model de Product ao inves de\n    //repetir informaçoes em order (colocar todos os dados dos produtos)\n\n    res.status(200).json({\n      success: true,\n      orders: orders\n    });\n  } catch (error) {\n    res.status(403).send(\"Please, login again.\");\n  }\n});","map":{"version":3,"sources":["/Users/renanyudi/Sites/estudos/react-app/react-next/pages/api/orders.js"],"names":["Order","jwt","connectDb","req","res","userId","verify","headers","authorization","process","env","JWT_SECRET","orders","find","populate","path","model","status","json","success","error","send"],"mappings":"AAAA,OAAOA,KAAP,MAAkB,oBAAlB;AACA,OAAOC,GAAP,MAAgB,cAAhB;AACA,OAAOC,SAAP,MAAsB,uBAAtB;AAEAA,SAAS;AACT,gBAAe,OAAOC,GAAP,EAAYC,GAAZ,KAAoB;AACjC,MAAI;AACF,UAAM;AAAEC,MAAAA;AAAF,QAAaJ,GAAG,CAACK,MAAJ,CAAWH,GAAG,CAACI,OAAJ,CAAYC,aAAvB,EAAsCC,OAAO,CAACC,GAAR,CAAYC,UAAlD,CAAnB;AACA,UAAMC,MAAM,GAAG,MAAMZ,KAAK,CAACa,IAAN,CAAW;AAAER,MAAAA,MAAM,EAAEA;AAAV,KAAX,EAA+BS,QAA/B,CAAwC;AAC3DC,MAAAA,IAAI,EAAE,kBADqD;AAE3DC,MAAAA,KAAK,EAAE;AAFoD,KAAxC,CAArB,CAFE,CAMF;AACA;AACA;;AACAZ,IAAAA,GAAG,CAACa,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB;AAACC,MAAAA,OAAO,EAAE,IAAV;AAAgBP,MAAAA,MAAM,EAAEA;AAAxB,KAArB;AACD,GAVD,CAUE,OAAMQ,KAAN,EAAa;AACbhB,IAAAA,GAAG,CAACa,MAAJ,CAAW,GAAX,EAAgBI,IAAhB,CAAqB,sBAArB;AACD;AACF,CAdD","sourcesContent":["import Order from \"../../models/Order\"\nimport jwt from \"jsonwebtoken\";\nimport connectDb from \"../../utils/connectDb\"\n\nconnectDb()\nexport default async (req, res) => {\n  try {\n    const { userId } = jwt.verify(req.headers.authorization, process.env.JWT_SECRET)\n    const orders = await Order.find({ userId: userId }).populate({\n      path: \"products.product\",\n      model: \"Product\"\n    })\n    //populate serve pra buscar as informaçoes do produto baseado no model Product, se nao tiver isso nao busca todas as infos dos produtos\n    //o que nao é interessante, uma vez que se com populate eu posso popular os dados de acordo com o id e o model de Product ao inves de\n    //repetir informaçoes em order (colocar todos os dados dos produtos)\n    res.status(200).json({success: true, orders: orders})\n  } catch(error) {\n    res.status(403).send(\"Please, login again.\")\n  }\n}"]},"metadata":{},"sourceType":"module"}