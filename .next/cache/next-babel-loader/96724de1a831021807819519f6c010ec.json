{"ast":null,"code":"import Product from \"../../models/Product\";\nimport connectDb from \"../../utils/connectDb\";\nconnectDb();\nexport default (async (req, res) => {\n  switch (req.method) {\n    case \"GET\":\n      await handleGetRequest(req, res);\n      break;\n\n    case \"POST\":\n      await handlePostRequest(req, res);\n      break;\n\n    case \"DELETE\":\n      await handleDeleteRequest(req, res);\n      break;\n\n    case \"PUT\":\n      await handlePutRequest(req, res);\n      break;\n\n    default:\n      res.status(405).send(`Method ${req.method} not allowed`);\n      break;\n  }\n});\n\nasync function handleGetRequest(req, res) {\n  const product = await Product.findOne({\n    _id: req.query.id\n  });\n\n  if (res.status(200)) {\n    res.json(product);\n  } else {\n    console.log(\"erro no get\");\n  }\n}\n\nasync function handlePostRequest(req, res) {\n  console.log(res);\n\n  try {\n    const {\n      name,\n      price,\n      description,\n      mediaUrl\n    } = req.body;\n\n    if (!name || !price || !description || !mediaUrl) {\n      return res.json({\n        success: false,\n        msg: \"Product missing one or more fields\"\n      });\n    }\n\n    const product = await new Product({\n      name,\n      price,\n      description,\n      mediaUrl\n    }).save();\n    res.status(201).json(product);\n  } catch (error) {\n    res.status(500).send(\"Server error in creating\");\n  }\n}\n\nasync function handleDeleteRequest(req, res) {\n  console.log(req);\n  await Product.findOneAndDelete({\n    _id: req.query.id\n  });\n\n  if (res.status(204)) {\n    res.json({});\n  }\n}\n\nasync function handlePutRequest(req, res) {}","map":{"version":3,"sources":["/Users/renanyudi/Sites/estudos/react-app/react-next/pages/api/product.js"],"names":["Product","connectDb","req","res","method","handleGetRequest","handlePostRequest","handleDeleteRequest","handlePutRequest","status","send","product","findOne","_id","query","id","json","console","log","name","price","description","mediaUrl","body","success","msg","save","error","findOneAndDelete"],"mappings":"AAAA,OAAOA,OAAP,MAAoB,sBAApB;AACA,OAAOC,SAAP,MAAsB,uBAAtB;AAEAA,SAAS;AAET,gBAAe,OAAMC,GAAN,EAAWC,GAAX,KAAmB;AAChC,UAAOD,GAAG,CAACE,MAAX;AACE,SAAK,KAAL;AACE,YAAMC,gBAAgB,CAACH,GAAD,EAAMC,GAAN,CAAtB;AACA;;AACF,SAAK,MAAL;AACE,YAAMG,iBAAiB,CAACJ,GAAD,EAAMC,GAAN,CAAvB;AACA;;AACF,SAAK,QAAL;AACE,YAAMI,mBAAmB,CAACL,GAAD,EAAMC,GAAN,CAAzB;AACA;;AACF,SAAK,KAAL;AACE,YAAMK,gBAAgB,CAACN,GAAD,EAAMC,GAAN,CAAtB;AACA;;AACF;AACEA,MAAAA,GAAG,CAACM,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAsB,UAASR,GAAG,CAACE,MAAO,cAA1C;AACA;AAfJ;AAiBD,CAlBD;;AAoBA,eAAeC,gBAAf,CAAgCH,GAAhC,EAAqCC,GAArC,EAA0C;AACxC,QAAMQ,OAAO,GAAG,MAAMX,OAAO,CAACY,OAAR,CAAgB;AAAEC,IAAAA,GAAG,EAAEX,GAAG,CAACY,KAAJ,CAAUC;AAAjB,GAAhB,CAAtB;;AACA,MAAIZ,GAAG,CAACM,MAAJ,CAAW,GAAX,CAAJ,EAAqB;AACnBN,IAAAA,GAAG,CAACa,IAAJ,CAASL,OAAT;AACD,GAFD,MAEO;AACLM,IAAAA,OAAO,CAACC,GAAR,CAAY,aAAZ;AACD;AACF;;AAED,eAAeZ,iBAAf,CAAiCJ,GAAjC,EAAsCC,GAAtC,EAA2C;AACzCc,EAAAA,OAAO,CAACC,GAAR,CAAYf,GAAZ;;AACA,MAAI;AACF,UAAM;AAAEgB,MAAAA,IAAF;AAAQC,MAAAA,KAAR;AAAeC,MAAAA,WAAf;AAA4BC,MAAAA;AAA5B,QAAyCpB,GAAG,CAACqB,IAAnD;;AACA,QAAI,CAACJ,IAAD,IAAS,CAACC,KAAV,IAAmB,CAACC,WAApB,IAAmC,CAACC,QAAxC,EAAkD;AAChD,aAAOnB,GAAG,CAACa,IAAJ,CAAS;AAAEQ,QAAAA,OAAO,EAAE,KAAX;AAAkBC,QAAAA,GAAG,EAAE;AAAvB,OAAT,CAAP;AACD;;AAED,UAAMd,OAAO,GAAG,MAAM,IAAIX,OAAJ,CAAY;AAChCmB,MAAAA,IADgC;AAEhCC,MAAAA,KAFgC;AAGhCC,MAAAA,WAHgC;AAIhCC,MAAAA;AAJgC,KAAZ,EAKnBI,IALmB,EAAtB;AAOAvB,IAAAA,GAAG,CAACM,MAAJ,CAAW,GAAX,EAAgBO,IAAhB,CAAqBL,OAArB;AACD,GAdD,CAcE,OAAMgB,KAAN,EAAa;AACbxB,IAAAA,GAAG,CAACM,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB,0BAArB;AACD;AAEF;;AAED,eAAeH,mBAAf,CAAmCL,GAAnC,EAAwCC,GAAxC,EAA6C;AAC3Cc,EAAAA,OAAO,CAACC,GAAR,CAAYhB,GAAZ;AACA,QAAMF,OAAO,CAAC4B,gBAAR,CAAyB;AAAEf,IAAAA,GAAG,EAAEX,GAAG,CAACY,KAAJ,CAAUC;AAAjB,GAAzB,CAAN;;AACA,MAAIZ,GAAG,CAACM,MAAJ,CAAW,GAAX,CAAJ,EAAqB;AACnBN,IAAAA,GAAG,CAACa,IAAJ,CAAS,EAAT;AACD;AACF;;AAED,eAAeR,gBAAf,CAAgCN,GAAhC,EAAqCC,GAArC,EAA0C,CAEzC","sourcesContent":["import Product from \"../../models/Product\";\nimport connectDb from \"../../utils/connectDb\";\n\nconnectDb(); \n\nexport default async(req, res) => {\n  switch(req.method) {\n    case \"GET\":\n      await handleGetRequest(req, res);\n      break;\n    case \"POST\":\n      await handlePostRequest(req, res);\n      break;\n    case \"DELETE\":\n      await handleDeleteRequest(req, res);\n      break;\n    case \"PUT\":\n      await handlePutRequest(req, res);\n      break;\n    default:\n      res.status(405).send(`Method ${req.method} not allowed`);\n      break;\n  }\n}\n\nasync function handleGetRequest(req, res) {\n  const product = await Product.findOne({ _id: req.query.id });\n  if (res.status(200)) {\n    res.json(product);\n  } else {\n    console.log(\"erro no get\")\n  }\n}\n\nasync function handlePostRequest(req, res) {\n  console.log(res);\n  try {\n    const { name, price, description, mediaUrl } = req.body\n    if (!name || !price || !description || !mediaUrl) {\n      return res.json({ success: false, msg: \"Product missing one or more fields\" });\n    }\n  \n    const product = await new Product({\n      name, \n      price, \n      description, \n      mediaUrl\n    }).save()\n  \n    res.status(201).json(product)\n  } catch(error) {\n    res.status(500).send(\"Server error in creating\");\n  }\n \n} \n\nasync function handleDeleteRequest(req, res) {\n  console.log(req)\n  await Product.findOneAndDelete({ _id: req.query.id });\n  if (res.status(204)) {\n    res.json({})\n  }\n}\n\nasync function handlePutRequest(req, res) {\n\n}"]},"metadata":{},"sourceType":"module"}