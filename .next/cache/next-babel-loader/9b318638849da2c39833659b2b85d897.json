{"ast":null,"code":"import Product from \"../../models/Product\";\nimport connectDb from \"../../utils/connectDb\";\nconnectDb();\nexport default (async (req, res) => {\n  const {\n    page,\n    size\n  } = req.query; //convert string value to number:\n\n  const pageNum = Number(page);\n  const pageSize = Number(size);\n  let products = [];\n  const totalDocs = await Product.countDocuments();\n  const totalPages = Math.ceil(totalDocs / pageSize);\n\n  try {\n    if (pageNum == 1) {\n      products = await Product.find().limit(pageSize);\n    } else {\n      const skips = pageSize * (pageNum - 1);\n      products = await Product.find().skip(skips).limit(pageSize);\n    }\n\n    if (res.statusCode == 200) {\n      res.status(200).json({\n        success: true,\n        products: products,\n        totalPages: totalPages\n      });\n    } else {\n      res.json({\n        success: false\n      });\n    }\n  } catch (error) {\n    res.status(500).send(\"Server error in creating\");\n  }\n});","map":{"version":3,"sources":["/Users/renanyudi/Sites/estudos/react-app/react-next/pages/api/products.js"],"names":["Product","connectDb","req","res","page","size","query","pageNum","Number","pageSize","products","totalDocs","countDocuments","totalPages","Math","ceil","find","limit","skips","skip","statusCode","status","json","success","error","send"],"mappings":"AAAA,OAAOA,OAAP,MAAoB,sBAApB;AACA,OAAOC,SAAP,MAAsB,uBAAtB;AAEAA,SAAS;AAET,gBAAe,OAAOC,GAAP,EAAYC,GAAZ,KAAoB;AACjC,QAAM;AAAEC,IAAAA,IAAF;AAAQC,IAAAA;AAAR,MAAiBH,GAAG,CAACI,KAA3B,CADiC,CAGjC;;AACA,QAAMC,OAAO,GAAGC,MAAM,CAACJ,IAAD,CAAtB;AACA,QAAMK,QAAQ,GAAGD,MAAM,CAACH,IAAD,CAAvB;AACA,MAAIK,QAAQ,GAAG,EAAf;AACA,QAAMC,SAAS,GAAG,MAAMX,OAAO,CAACY,cAAR,EAAxB;AACA,QAAMC,UAAU,GAAGC,IAAI,CAACC,IAAL,CAAUJ,SAAS,GAAGF,QAAtB,CAAnB;;AACA,MAAI;AACF,QAAIF,OAAO,IAAI,CAAf,EAAkB;AAChBG,MAAAA,QAAQ,GAAG,MAAMV,OAAO,CAACgB,IAAR,GAAeC,KAAf,CAAqBR,QAArB,CAAjB;AACD,KAFD,MAEO;AACL,YAAMS,KAAK,GAAGT,QAAQ,IAAIF,OAAO,GAAG,CAAd,CAAtB;AACAG,MAAAA,QAAQ,GAAG,MAAMV,OAAO,CAACgB,IAAR,GAAeG,IAAf,CAAoBD,KAApB,EAA2BD,KAA3B,CAAiCR,QAAjC,CAAjB;AACD;;AAED,QAAIN,GAAG,CAACiB,UAAJ,IAAkB,GAAtB,EAA2B;AACzBjB,MAAAA,GAAG,CAACkB,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB;AAACC,QAAAA,OAAO,EAAE,IAAV;AAAgBb,QAAAA,QAAQ,EAAEA,QAA1B;AAAoCG,QAAAA,UAAU,EAAEA;AAAhD,OAArB;AACD,KAFD,MAEO;AACLV,MAAAA,GAAG,CAACmB,IAAJ,CAAS;AAACC,QAAAA,OAAO,EAAE;AAAV,OAAT;AACD;AAEF,GAdD,CAcE,OAAMC,KAAN,EAAa;AACbrB,IAAAA,GAAG,CAACkB,MAAJ,CAAW,GAAX,EAAgBI,IAAhB,CAAqB,0BAArB;AACD;AACF,CA1BD","sourcesContent":["import Product from \"../../models/Product\";\nimport connectDb from \"../../utils/connectDb\";\n\nconnectDb(); \n\nexport default async (req, res) => {\n  const { page, size } = req.query;\n\n  //convert string value to number:\n  const pageNum = Number(page);\n  const pageSize = Number(size);\n  let products = [];\n  const totalDocs = await Product.countDocuments()\n  const totalPages = Math.ceil(totalDocs / pageSize)\n  try {\n    if (pageNum == 1) {\n      products = await Product.find().limit(pageSize)\n    } else {\n      const skips = pageSize * (pageNum - 1)\n      products = await Product.find().skip(skips).limit(pageSize)\n    }\n\n    if (res.statusCode == 200) {\n      res.status(200).json({success: true, products: products, totalPages: totalPages})\n    } else {\n      res.json({success: false})\n    }\n\n  } catch(error) {\n    res.status(500).send(\"Server error in creating\");\n  }\n}"]},"metadata":{},"sourceType":"module"}